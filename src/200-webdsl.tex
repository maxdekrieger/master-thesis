% !TEX root = document.tex

\chapter{\label{chap:webdsl}WebDSL}

  In this chapter, we describe WebDSL. WebDSL is a domain-specific language for developing web applications. The language incorporates ideas from various web programming frameworks and produces code for all tiers in a web application \autocite{Groenewegen2020}. Ever since its introduction over 10 years ago \autocite{Visser2007}, WebDSL has been the subject of many published papers (cite some papers here) and on top of that, is the programming language underpinning several applications used daily by thousands of users. Examples of WebDSL applications include but are not limited to:
  \begin{itemize}
    \item \textbf{WebLab}: An online learning management system, used by the Delft University of Technology.
    \item \textbf{conf.researchr.org}: A domain-specific content management system for conferences, used by all ACM SIGPLAN and SIGSOFT conferences.
    \item \textbf{researchr.org}: A platform for finding, collecting, sharing, and reviewing scientific computer science related publications.
  \end{itemize}

  \begin{itemize}
    \item [\textbf{TO-DO:}]
    \item Paragraph with strong points of WebDSL
  \end{itemize}

  The rest of this chapter showcases the different aspects of WebDSL and zooms in on its non-trivial features. First, in \cref{sec:ui} we will describe how WebDSL offers functionality for creating web user interfaces. Next, in \cref{sec:data-model} we illustrate how the langauge manages data models. Thirdly, \cref{sec:access-control} contains information about WebDSL's solution for access control and in \cref{sec:functions} we highlight interesting aspects of its general-purpose object oriented function code. We concluse this chapter by going in detail about WebDSL's current implementation in \cref{sec:current-implementation}.

  \section{\label{sec:why-webdsl}Why WebDSL as case study?}

  WebDSL is an interesting case study for SDF3 and Statix because of two main reasons. Firstly, WebDSL has a large amount of language features inspired by multiple paradigms of programming languages. This means the resulting SDF3 and Statix specifications are arguably the largest specifications to date. Accompanied by the large amount of publicly available source code for evaluation purposes, we aim to make observations about the elegancy of the resulting specifications and the scalability of their performance. Since this thesis is a case study, we cannot make general claims about the performance of SDF3 and Statix, but only reveal and analyse results of the WebDSL specification.

  Secondly, WebDSL contains language features that have never been modelled in Statix before. Specifically, those features are:

  \begin{itemize}
    \item Bi-directional type extension
    \begin{itemize}
      \item TO-DO:
      \item Is there a better name for this?
    \end{itemize}
    \item Generated functions and classes
    \item A peculiar module system
    \item TO-DO:
    \item Are there more unique features?
  \end{itemize}

  With the implementation of those features in Statix, we aim to contribute to assessing whether Statix is capable of modelling the static semantics of all programming languages.

  \section{\label{sec:ui}User Interfaces}

    Introduction

    \subsection{\label{subsec:building-blocks}Building blocks and Syntax}

      Domain specific language for web applications -> the UI is how the user interacts with the application.
      \\\\Page is the entry point, arguments are clean URL parameters. \\\\Templates are reusable components that can be inserted on pages or in other templates.
      \\\\Short example with three boxes next to each other (WebDSL code left, resulting HTML right, resulting UI bottom):
      \\\\Functionalities for in example:
      \\- Pages
      \\- Templates
      \\- Navigate
      \\- Text
      \\- Divs
      \\- HTML elements

    \subsection{\label{subsec:request-processing}Request processing and Action Code}

      With the building blocks of the previous subsection, only static pages can be made.
      \\\\Need HTML forms and submits to manipulate data.
      \\\\WebDSL abstracts over the usual manual request processing by using forms, inputs and action code.
      \\\\Functionalities for in example:
      \\- Form
      \\- Multiple input sorts (boolean, string, text)
      \\- Action with different redirects based on boolean, pass string to new page

    \subsection{\label{subsec:template-overriding}Template Overriding and Overloading}

    \subsection{\label{subsec:redefines}Dynamically scoped redefines}

    \subsection{\label{subsec:ajax}Ajax}

  \section{\label{sec:data-model}Data Model}

    \begin{itemize}
      \item Syntax
      \item Inheritance
      \item Extending entities
    \end{itemize}

  \section{\label{sec:access-control}Access Control}

    \begin{itemize}
      \item Syntax
      \item Inferred visibility
      \item Nested rules
      \item Pointcuts
    \end{itemize}

  \section{\label{sec:functions}Functions}

    \begin{itemize}
      \item Syntax
      \item Entities as classes
      \item Hooks for entity setters
      \item Extending functions
    \end{itemize}

  \section{\label{sec:current-implementation}Current Implementation}

    \subsection{\label{subsec:spoofax}Spoofax Language Workbench}

      \begin{itemize}
        \item History
        \item Goal
        \item Achievements
      \end{itemize}

    \subsection{\label{subsec:current-implementation}Current Implementation of WebDSL}

      \begin{itemize}
        \item Large Stratego specification where desugaring, static analysis, optimization and code-generation are interleaved (exaggeration?)
        \item Side effects using dynamic rules.
        \item Unexpected consequences of changes due to limited static analysis in untyped setting.
      \end{itemize}

      Go over some interesting WebDSL features and how they are implemented:
      \begin{itemize}
        \item Access control
        \item Template overloading and overriding
        \item Entity extension
      \end{itemize}

  \section{\label{sec:modernization}Modernization goal}

    \begin{itemize}
      \item A complete and maintainable SDF3 and Statix specification of WebDSL.
      \item Gather insight into the capabilities, elegance and performance of SDF3 and Statix.
      \item (Incrementalization for free leveraging the parallel Statix solver)
    \end{itemize}
