% !TEX root = document.tex

\chapter{\label{chap:sdf3}WebDSL in SDF3}

  \section{Introduction to SDF3}

    \begin{itemize}
      \item Syntax
      \item Disambiguation
    \end{itemize}
  
  \section{WebDSL Grammar}

  \section{Migration from SDF2 to SDF3}

    \begin{itemize}
      \item Preparation for migration:
        \begin{itemize}
          \item Remove alternations
          \item Remove restrictions
          \item Remove parameterized sorts and parameterized imports
        \end{itemize}
      \item Duplicate constructors, normalize constructors with Stratego desugaring
      \item Priority chains are not transferred
      \item Comments removed
      \item Implement templates for pretty-printing
      \item Merge syntax definition of previously mixed HQL
    \end{itemize}

  \section{Preparation for Statix}

    With the intention to use Statix for implementing the WebDSL static analyses, the grammar sorts and constructors have strict requirements. Statix is a strongly typed language and requires all input to adhere to the declared sorts and constructors.

    \subsection{Sorts and Constructors in Statix}

      \begin{itemize}
        \item Syntax
        \item Usage in rules
        \item Difference from SDF3
      \end{itemize}

    \subsection{Statix Signature Generator}

      \begin{itemize}
        \item Conversion from SDF3 constructors to Statix
        \item Optional sorts
        \item Injections
        \item Disambiguation (ref to separate section)
      \end{itemize}

    \subsection{Changing the SDF3 WebDSL Specification}

      \begin{itemize}
        \item Lots of new sorts due to explicit optional sorts
        \item Desugar new optional sorts
        \item Add more constructors for the removal of injections
      \end{itemize}

  \section{Disambiguation}
  
    Since the \texttt{amb(\_,\_)} constructor is not declarable in Statix, having an ambiguity in the AST leads to the analysis not executing. This increases the need for disambiguation.

    Challenges and solutions:
    \begin{itemize}
      \item Keywords in WebDSL: SDF3 template options not optimal.
      \item String interpolation: Convert to one String constructor with a list of parts.
      \item Optional separators: In SDF2 multiple productions could have the same constructor, in SDF3 multiple constructors make for an increase in reject and desugaring rules.
      \item Optional alias vs. cast expression: use non-transitive priority rule.
    \end{itemize}
